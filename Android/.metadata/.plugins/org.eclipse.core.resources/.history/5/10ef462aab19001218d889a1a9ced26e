package com.motlee.android.fragment;

import java.util.Calendar;

import com.motlee.android.R;
import com.motlee.android.layouts.StretchedBackgroundTableLayout;
import com.motlee.android.object.EventDetail;
import com.motlee.android.object.GlobalVariables;
import com.motlee.android.object.UserInfoList;
import com.nostra13.universalimageloader.core.DisplayImageOptions;
import com.nostra13.universalimageloader.core.ImageLoader;
import com.nostra13.universalimageloader.core.ImageLoaderConfiguration;
import com.nostra13.universalimageloader.core.assist.ImageScaleType;
import com.nostra13.universalimageloader.core.display.SimpleBitmapDisplayer;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.text.Editable;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewGroup.LayoutParams;
import android.widget.ImageView;
import android.widget.TextView;

public class UserProfilePageFragment extends Fragment {

	public static String START_TIME = "StartTime";
	public static String END_TIME = "EndTime";
	
	private View view;
	private LayoutInflater inflater;
	private String pageTitle = "Create Event";
	private int mUserID;
	
	private StretchedBackgroundTableLayout eventInfoLayout;
	
    private ImageLoader imageDownloader;
    private DisplayImageOptions mOptions;
    
    private String pictureURL;
	
	@Override
	public View onCreateView(LayoutInflater inflater, ViewGroup container, 
	        Bundle savedInstanceState)
	{
	
		this.inflater = inflater;
		view = (View) this.inflater.inflate(R.layout.activity_event_detail_more, null);
		
		eventInfoLayout = (StretchedBackgroundTableLayout) view.findViewById(R.id.event_detail_info);
		eventInfoLayout.setBackgroundDrawable(getResources().getDrawable( R.drawable.label_button_background));
		
		TextView tv = (TextView) view.findViewById(R.id.header_textView);
		tv.setText(UserInfoList.getInstance().get(mUserID).name);
		tv.setTypeface(GlobalVariables.getInstance().getGothamLightFont());
		
		View headerRightButton = view.findViewById(R.id.header_right_layout_button);
		headerRightButton.setVisibility(View.VISIBLE);
		
		TextView headerText = (TextView) view.findViewById(R.id.header_right_text);
		headerText.setText("Start!");

		ImageScaleType ist = ImageScaleType.IN_SAMPLE_POWER_OF_2;
		
		mOptions = new DisplayImageOptions.Builder()
		.showStubImage(R.drawable.stubimage)
		.resetViewBeforeLoading()
		.cacheInMemory()
		.imageScaleType(ist)
		.cacheOnDisc()
		.displayer(new SimpleBitmapDisplayer())
		.build();
		
		imageDownloader = ImageLoader.getInstance();
    	
    	imageDownloader.init(ImageLoaderConfiguration.createDefault(getActivity()));
		
    	setPictureURL();
    	
		setPageLayout();
    	
		return view;
	}
	
	private void setPictureURL() {
		
		pictureURL = "https://graph.facebook.com/" + UserInfoList.getInstance().get(mUserID) + "/picture";
		
	}

	public void setUserId(int userID)
	{
		this.mUserID = userID;
	}
	
	
	private void setPageLayout()
	{
		View thumbnailView = inflater.inflate(R.layout.thumbnail, null);
		thumbnailView.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT));
		ImageView imageView = (ImageView) thumbnailView.findViewById(R.id.imageThumbnail);
		
		imageDownloader.displayImage(pictureURL, imageView, mOptions);
		
		
	}
}
