package com.motlee.android.adapter;

import java.util.List;

import com.motlee.android.R;
import com.motlee.android.adapter.SearchAllAdapter.EventViewHolder;
import com.motlee.android.object.DrawableCache;
import com.motlee.android.object.EventDetail;
import com.motlee.android.object.GlobalEventList;
import com.motlee.android.object.GlobalVariables;
import com.motlee.android.object.UserInfo;
import com.motlee.android.object.UserInfoList;

import android.content.Context;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

public class UserProfileAdpater extends ArrayAdapter<Integer> {

	public UserProfileAdpater(Context context, int textViewResourceId, List<Integer> objects) {
		super(context, textViewResourceId, objects);
		// TODO Auto-generated constructor stub
	}

	@Override
	public View getView(int position, View convertView, ViewGroup parent) 
	{

		EventViewHolder holder = new EventViewHolder();
		
        if (convertView == null) 
        {
        	Log.w(this.toString(), "inflating resource: " + R.layout.search_event_item);
        	
            convertView = setEventViewHolder(holder);
        } 
        else 
        {
        	holder = (EventViewHolder) convertView.getTag();
        }
        
        if (convertView.getBackground() == null)
        {
        	convertView.setBackgroundDrawable(DrawableCache.getDrawable(R.drawable.label_button_no_arrow, GlobalVariables.DISPLAY_WIDTH).getDrawable());
        }
        
        EventDetail event = GlobalEventList.eventDetailMap.get(this.mListItems.get(position));
    	
        convertView.setContentDescription(event.getEventID().toString());
        
        holder.search_button.setContentDescription(event.getEventID().toString());
        holder.search_button.setTag(event);
        
        holder.search_event_picture.setMaxHeight(DrawableCache.getDrawable(R.drawable.label_button_no_arrow, GlobalVariables.DISPLAY_WIDTH).getHeight());
        
        if (event.getImages().size() > 0)
        {
        	GlobalVariables.getInstance().downloadImage(holder.search_event_picture, GlobalVariables.getInstance().getAWSUrlThumbnail(event.getImages().get(0)));
        }
        else
        {
        	holder.search_event_picture.setImageDrawable(getContext().getResources().getDrawable(R.drawable.watermark));
        }
        
        holder.search_event_name.setText(event.getEventName());
        holder.search_event_name.setTypeface(GlobalVariables.getInstance().getHelveticaNeueBoldFont());
        
        holder.search_attendee_count.setText(event.getAttendeeCount() + " Attendees");
        holder.search_attendee_count.setTypeface(GlobalVariables.getInstance().getHelveticaNeueBoldFont());
	            

		return convertView;
	}
	
	private View setEventViewHolder(EventViewHolder eventHolder) {
		View convertView;
		
		convertView = this.inflater.inflate(R.layout.search_event_item, null);
		
		eventHolder.search_event_picture = (ImageView) convertView.findViewById(R.id.search_event_picture);
		eventHolder.search_event_name = (TextView) convertView.findViewById(R.id.search_event_name);
		eventHolder.search_attendee_count = (TextView) convertView.findViewById(R.id.search_attendee_count);
		eventHolder.search_button = convertView.findViewById(R.id.search_button);
		
		convertView.setTag(eventHolder);
		return convertView;
	}
	
	private class EventViewHolder
	{
		public ImageView search_event_picture;
		public TextView search_event_name;
		public TextView search_attendee_count;
		public View search_button;
	}
}
